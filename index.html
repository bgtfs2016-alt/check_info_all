<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tra c·ª©u POSID</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <style>
    body { padding-top: 70px; padding-bottom: 60px; }
    footer {
      position: fixed;
      bottom: 0; left: 0; right: 0;
      background: #f8f9fa;
      text-align: center;
      padding: 10px;
      border-top: 1px solid #ddd;
    }
    table { word-wrap: break-word; }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">üîé Tra c·ª©u POSID</a>
    </div>
  </nav>

  <!-- N·ªôi dung -->
  <div class="container mt-4">
    <div class="card shadow">
      <div class="card-header bg-primary text-white">Nh·∫≠p POSID ƒë·ªÉ tra c·ª©u</div>
      <div class="card-body">
        <div class="input-group mb-3">
          <input type="text" id="searchInput" class="form-control" placeholder="Nh·∫≠p POSID...">
          <button class="btn btn-success" onclick="searchPOS()">T√¨m ki·∫øm</button>
        </div>
        <div class="table-responsive">
          <table class="table table-bordered table-striped">
            <thead class="table-dark">
              <tr id="tableHead"></tr>
            </thead>
            <tbody id="resultTable">
              <tr><td colspan="100%" class="text-center">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    ¬© 2025 B·∫£n quy·ªÅn - Tra c·ª©u POSID
  </footer>

<script>
  // Supabase config
  const SUPABASE_URL = "https://oxbvzqdfltdaqwupafqh.supabase.co"; // üëâ thay b·∫±ng Project URL
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im94YnZ6cWRmbHRkYXF3dXBhZnFoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcwNDExODUsImV4cCI6MjA3MjYxNzE4NX0.gDYsSiPRHOL25jbENmXq4Jf6zIkR--dSaHi2F6M5-ko"; // üëâ thay b·∫±ng Anon Key
  const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  async function searchPOS() {
  const posId = document.getElementById("searchInput").value.trim();
  const tableHead = document.getElementById("tableHead");
  const resultTable = document.getElementById("resultTable");

  if (!posId) {
    resultTable.innerHTML = `<tr><td colspan="100%" class="text-center">Vui l√≤ng nh·∫≠p POSID</td></tr>`;
    return;
  }

  // √âp ki·ªÉu int v√¨ pos_id l√† int8 trong Supabase
  const { data, error } = await supabase
    .from("replacetiengiang")
    .select("*")
    .eq("pos_id", parseInt(posId));

  console.log("T√¨m POSID:", posId);
  console.log("K·∫øt qu·∫£:", data);
  console.log("L·ªói:", error);

  if (error) {
    resultTable.innerHTML = `<tr><td colspan="100%" class="text-danger">L·ªói: ${error.message}</td></tr>`;
    return;
  }

  if (!data || data.length === 0) {
    resultTable.innerHTML = `<tr><td colspan="100%" class="text-center">Kh√¥ng t√¨m th·∫•y POSID</td></tr>`;
    return;
  }

  // Hi·ªÉn th·ªã header (c·ªôt)
  tableHead.innerHTML = "";
  Object.keys(data[0]).forEach(key => {
    tableHead.innerHTML += `<th>${key}</th>`;
  });

  // Hi·ªÉn th·ªã d·ªØ li·ªáu
  resultTable.innerHTML = "";
  data.forEach(row => {
    let rowHtml = "<tr>";
    Object.values(row).forEach(val => {
      rowHtml += `<td>${val ?? ""}</td>`;
    });
    rowHtml += "</tr>";
    resultTable.innerHTML += rowHtml;
  });
}


  // Enter ƒë·ªÉ t√¨m
  document.getElementById("searchInput").addEventListener("keypress", function(e) {
    if (e.key === "Enter") searchPOS();
  });
</script>
</body>
</html>

